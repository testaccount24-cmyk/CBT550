         MACRO
&NAME    BEGTEST &LVL,                                                 C
               &PRINT=        CODE 'PRINT=NO' TO SUPPRESS SKIPPED STMTS
.* OR 'PRINT=YES' TO PRINT SKIPPED STMTS OR CHANGE IT IN THIS MACRO
.* DEFINITION TO CHANGE IT TO SAY '&PRINT=NO' TO MAKE 'NO' THE DEFAULT
.*
.*                              IN 'OPEN' CODE DO ONE OF THE FOLLOWING:
         GBLA  &TESTLVL         1. SET TO > 0 TO ACTIVATE - OR -
         GBLC  &$A,&$B,&$C,&$D  2. SET ONE OR MORE TO 'Y' TO ACTIVATE
         GBLC  &$MPRSW          TO KEEP TRACK OF USER'S PREF
         LCLA  &I,&J
         LCLC  &TEXT
         AIF   ('&PRINT' EQ '').SKIP005 GO IF NO PARM SPECIFIED
&$MPRSW  SETC  '&PRINT'                SET GLOBAL TO USER'S VALUE
.SKIP005 AIF   ('&NAME' EQ '').SKIP010
&NAME    EQU   *
.SKIP010 AIF   ('&LVL' NE '' AND '&LVL'(1,1) GT 'Z').TEST510
         AIF   ('&LVL' NE 'A').TEST020 FALL THRU IF 'A'
         AIF   ('&$A' EQ 'Y').MEND999  IF 'Y' THEN INCLUDE THRU ENDTEST
         AGO   .LOOP520                IF NOT THEN EXCLUDE THRU ENDTEST
.TEST020 AIF   ('&LVL' NE 'B').TEST030 FALL THRU IF 'B'
         AIF   ('&$B' EQ 'Y').MEND999  IF 'Y' THEN INCLUDE THRU ENDTEST
         AGO   .LOOP520                IF NOT THEN EXCLUDE THRU ENDTEST
.TEST030 AIF   ('&LVL' NE 'C').TEST040 FALL THRU IF 'C'
         AIF   ('&$C' EQ 'Y').MEND999  IF 'Y' THEN INCLUDE THRU ENDTEST
         AGO   .LOOP520                IF NOT THEN EXCLUDE THRU ENDTEST
.TEST040 AIF   ('&LVL' NE 'D').MSG050  FALL THRU IF 'D'
         AIF   ('&$D' EQ 'Y').MEND999  IF 'Y' THEN INCLUDE THRU ENDTEST
         AGO   .LOOP520                IF NOT THEN EXCLUDE THRU ENDTEST
.MSG050  MNOTE *,' ---> INVALID CHAR OPERAND &LVL - OPT CODE INCLUDED'
         AGO   .MEND999
.TEST510 AIF   (&LVL LE &TESTLVL).MEND999 IF LE THEN INCL THRU ENDTEST
.LOOP520 AIF   ('&$MPRSW' EQ 'YES').NEXT523 'DEFAULT' IS SUPPRESS
&TEXT    AREAD NOPRINT            READ STMT AND SUPPRESS PRINT
         AGO   .NEXT526
.NEXT523 ANOP
&TEXT    AREAD NOSTMT            READ AND PRINT STMT BUT NO LINE NUMBER
.NEXT526 AIF   ('&TEXT'(1,1) EQ '*').LOOP520 SKIP COMMENT STMTS
&J       SETA  &J+1                    COUNT THIS STMT
&I       SETA  1                       GET READY TO INSPECT STMT
.LOOP530 AIF   ('&TEXT'(&I,1) EQ ' ').NEXT540 SCAN PAST NAME FIELD
&I       SETA  &I+1                    INCR PTR TO NEXT POS
         AIF   (&I GT 65).LOOP520      GET NEXT STMT IF COL 65
         AGO   .LOOP530                KEEP SCANNING NAME FIELD
.NEXT540 AIF   ('&TEXT'(&I,1) NE ' ').NEXT550 SCAN PAST LEADING SPACES
&I       SETA  &I+1                    INCR TO NEXT POS
         AIF   (&I GT 65).LOOP520      GET NEXT STMT IF COL 65
         AGO   .NEXT540                KEEP SCANNING SPACES
.NEXT550 AIF   ('&TEXT'(&I,8) NE 'ENDTEST ').LOOP520 SECRET KEYWORD?
&J       SETA  &J-1                    YES - DECREMENT IMAGE COUNT
         AIF   (&J NE 1).MSG560        FORMAT NICELY
         MNOTE *,' ===> ENDTEST STATEMENT ENCOUNTERED - 1 STATEMENT SKIX
               PPED'
         AGO   .MEND999
.MSG560  MNOTE *,' ===> ENDTEST STATEMENT ENCOUNTERED - &J STATEMENTS SX
               KIPPED'
.MEND999 MEND
